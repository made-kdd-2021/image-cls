# Репозиторий для классификации изображений

## Требования для запуска

1. Python 3.8 или выше.
2. Для GPU видеокарта с поддержкой CUDA 11.1.
3. [Доступ в Google Drive для DVC.](https://dvc.org/doc/user-guide/setup-google-drive-remote)

## Как запустить

### Зависимости

Установка PyTorch с GPU:
```
pip install -r ./requirements.gpu.txt
```

PyTorch с CPU только:
```
pip install -r ./requirements.cpu.txt
```

Установить зависимости только после установки PyTorch:
```
pip install -r. /requirements.txt -r ./requirements.dev.txt
```

Скачать данные из DVC:
```
dvc pull
```

### Запуск обучения

Все стадии можно посмотреть через:
```
dvc dag
```

В `configs` находятся все основные параметры обучения. Для проведения эксперимента достаточно поменять значения и запустить обучение с финальной оценкой:
```
dvc repro test
```

После выполнения всех стадий результаты предсказаний на `test` будут сохранены в файл `prediction.csv`.

Для просмотра метрик достаточно выполнить:
```
dvc metrics show
```

Метрики из `test_metrics` учитывать не нужно т. к. это результат тестового запуска обучения для автотестирования.

При внесении изменений в код необходимо запустит тесты и проверить работу:
```
dvc repro fast-tes
```

### Запуск тестов:
```
pytest --cov=model --cov=training ./tests
```
